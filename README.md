# CSCI390-File-Inclusion-Vulnerability-Demo
Due date: 11/14/2022

<p align="center"><img width=60% src="https://user-images.githubusercontent.com/69567092/201555143-8e72e5bb-8980-42b6-b9fb-481a65a274c6.png"></p>

## What is File Inclusion Vulnerability?


<table>
<tr>
<td>
  
**File Inclusion Vulnerability** is a PHP script-based exploit that allows an attacker to include a file on the web server. When a web application allows the client to enter data into files or upload files to the server, this vulnerability occurs. A file inclusion vulnerability differs from a general Directory Traversal Attack in that directory traversal allows unauthorized file system access, but a file inclusion vulnerability alters how an application loads code for execution. Exploiting a file includes vulnerability successfully will result in remote code execution on the web server that hosts the vulnerable web application.

This can lead to something as outputting the contents of the file, but depending on the severity, it can also lead to:

* Code execution on the web server
* Code execution on the client-side such as JavaScript which can lead to other attacks such as cross site scripting (XSS)
* Denial of Service (DoS)
* Sensitive Information Disclosure

Two Types:

  1. **Local File Inclusion**
      * LFI vulnerabilities allow an attacker to read or execute files on the victim machine.

  2. **Remote File Inclusion**
      * RFI vulnerabilities allow an attacker to read or execute files hosted on their own machine.

</td>
</tr>
</table>

## Downloading and installing:
I am using DVWA (DAMN VULNERABLE WEB APPLICATION) to demo this vulnerability and to download it run
```bash
git clone https://github.com/digininja/DVWA.git
```

for windows you can follow this installation guide 
  * [Installing Damn Vulnerable Web Application (DVWA) on Windows 10](https://www.youtube.com/watch?v=cak2lQvBRAo)
  * You need to install:
[DVWA](https://github.com/digininja/DVWA)
&
[XAMPP](https://www.apachefriends.org/download.html)

for other OS please refer to this DVWA github page:
https://github.com/digininja/DVWA

## Examples:
Vulnerable code

1. ![ex](https://user-images.githubusercontent.com/69567092/201559276-a7db323e-5c59-4849-b188-9a6714ea5d99.png)
2. ![ex](https://user-images.githubusercontent.com/69567092/201559627-0e567ecd-8c92-4dea-b226-1520adc2c657.png)

Fixed code

![Screenshot_2020-03-18_14-24-12-768x323-3189405755](https://user-images.githubusercontent.com/69567092/201560075-9422cc72-810a-4f75-abc8-12cf3e85a379.png)





## Resources:
* [DVWA github](https://github.com/digininja/DVWA)
* [DVWA FI walkthrough](https://medium.com/@manjuteju008/understanding-file-inclusion-attack-using-dvwa-web-application-30d06846c269)
* [offensive-security FI](https://www.offensive-security.com/metasploit-unleashed/file-inclusion-vulnerabilities/)
* [DVWA RFI](https://hacking.tamalweb.com/dvwa-remote-file-inclusion-rfi-vulnerability)
* [FI CheatSheat](https://github.com/MalwareBro/File_Inclusion_CheatSheet/blob/main/File_Inclusion_CheatSheet.md)
* [OWASP LFI](https://owasp.org/www-project-web-security-testing-guide/v42/4-Web_Application_Security_Testing/07-Input_Validation_Testing/11.1-Testing_for_Local_File_Inclusion)
* [OWASP RFI](https://owasp.org/www-project-web-security-testing-guide/v42/4-Web_Application_Security_Testing/07-Input_Validation_Testing/11.2-Testing_for_Remote_File_Inclusion)
* [YouTube Walkthrough](https://youtu.be/KY58WcX7OZ4)
* [php-reverse-shell](https://github.com/pentestmonkey/php-reverse-shell)
